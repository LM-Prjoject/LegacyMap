services:
  - type: web
    name: legacy-backend
    env: docker
    plan: free
    autoDeploy: true
    region: frankfurt            # ✅ chuyển sang EU (gần London eu-west-2)

    envVars:
      # === DATABASE (khớp Supabase eu-west-2) ===
      - key: DB_URL
        value: jdbc:postgresql://aws-1-eu-west-2.pooler.supabase.com:5432/postgres?sslmode=require
      - key: DB_USERNAME
        value: postgres.ygwvctvwonegiyrhjjdp
      - key: DB_PASSWORD
        sync: false

      # === MAIL ===
      - key: SMTP_HOST
        sync: false
      - key: SMTP_PORT
        sync: false
      - key: SMTP_USERNAME
        sync: false
      - key: SMTP_PASSWORD
        sync: false
      - key: MAIL_FROM
        sync: false

      # === GOOGLE OAUTH ===
      - key: GOOGLE_CLIENT_ID
        sync: false
      - key: GOOGLE_CLIENT_SECRET
        sync: false

      # === JWT & FE URL ===
      - key: JWT_SECRET
        sync: false
      - key: FRONTEND_URL
        value: https://legacy-map-ebon.vercel.app

      # === Cookie (nếu FE khác domain và cần gửi cookie) ===
      - key: COOKIE_SAMESITE
        value: None
      - key: COOKIE_SECURE
        value: "true"

      # === JVM: ưu tiên IPv4 ===
      - key: JAVA_TOOL_OPTIONS
        value: -Djava.net.preferIPv4Stack=true -Djava.net.preferIPv6Addresses=false
